{% extends "base.html" %}

{% block body %}
<header class="header">
    <div class="container logo-nav-container">
        <a href="#" class="logo">HOTAI MOTOR</a>
        <nav class="navigation">
            <ul>

                <li><a href="{{ url_for('mostrar_usuario') }}">Usuario</a></li>
                <li><a href="{{ url_for('mostrar_productos') }}">Productos</a></li>
                <li><a href="{{ url_for('mostrar_proveedores') }}">Proveedores</a></li>
                <!---<li><a href="#">Salir</a></li>-->
            </ul>
        </nav>
    </div>
</header>


<!-- ==========================================--> 
<!-- CUERPO DE LA PAGINA -->
<!-- ==========================================-->
<body id="page-top">

<!-- ========================================================--> 
<!-- INICIA PÁGINA ENVLVENTE -->
<!-- ========================================================-->
<!-- Page Wrapper -->
<div id="wrapper">   


<!-- ========================================================--> 
<!-- INICIA  CONTENIDO ENVLVENTE -->
<!-- ========================================================-->
<!-- Content Wrapper -->
<div id="content-wrapper" class="d-flex flex-column">

    <!-- Main Content -->
    <div id="content">
        
        <!-- ========================================================--> 
        <!-- BARRA SUPERIOR -->
        <!-- ========================================================-->
        <!-- Topbar -->
        <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

            <!-- Sidebar Toggle (Topbar) -->
            <form class="form-inline">
                <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                    <i class="fa fa-bars"></i>
                </button>
            </form>

            <ul class="navbar-nav ml-auto">                          

                <!-- ========================================================--> 
                <!-- BOTÓN DE NAVEGACIÓN DE LA INFORMACIÓN DEL USUARIO -->
                <!-- ========================================================-->
                <!-- Nav Item - User Information -->
                <li class="nav-item dropdown no-arrow">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="mr-2 d-none d-lg-inline text-gray-600 small">Alexander Rudas {{ nombre }}</span>
                        <img class="img-profile rounded-circle"
                            src="static/img/undraw_profile.svg">
                    </a>
                    <!-- Dropdown - User Information -->
                    <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                        aria-labelledby="userDropdown">
                        <a class="dropdown-item" href="#">
                            <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                            Perfil
                        </a>
                                                       
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                            <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                            Cerrar Sesión
                        </a>
                    </div>
                </li>                        
            </ul>
        </nav>
        <!-- ========================================================--> 
        <!-- FIN MENÚ DE NAVEGACIÓN DE LA INFORMACIÓN DEL USUARIO -->
        <!-- ========================================================-->
        <!-- End of Topbar -->



        <!-- ========================================================--> 
        <!-- INICIO CONTENIDO DE PÁGINA -->
        <!-- ========================================================-->
        <!-- Begin Page Content -->
        <div class="container-fluid">

            <!-- TÍTULO DE LA PÁGINA - Page Heading -->
            <h1 class="h3 mb-2 text-gray-800">Usuarios</h1> 
            
                

            <!-- DataTales Example -->
            <div class="content">
                {% with messages = get_flashed_messages()  %}
                {% if messages %}
                {% for message in messages %}
                <div class="alert alert-info alert-dismissible fade show" role="alert">
                  {{ message }}
                  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                {% endfor %}
                {% endif %}
                {% endwith %}
                <div class="animated">   
                    
            <!-- ========================================================--> 
            <!-- INICIA MODAL  -->
            <!-- ========================================================-->
                

            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <div class="mb-4"></div>     

                    <!-- Button trigger modal -->                 
                    <button type="button" class="btn btn-primary mb-0"" data-toggle="modal" data-target="#mediumModal">
                       + Agregar Usuario
                    </button>  

                    <!-- <button type="button" class="btn btn-primary mb-0" data-toggle="modal" data-target="#largeModal">
                        Editar Usuario
                    </button> -->

                    <!-- <button type="button" class="btn btn-primary mb-0" data-toggle="modal" data-target="#Modal">
                        Eliminar Usuario
                    </button> -->
                    

                    <!--********************************************************-->
                    <!--********      MODAL DE AGRAGAR USUARIOS      ***********-->
                    <!--********************************************************-->

                    <div class="modal fade" id="mediumModal" tabindex="-1" role="form" aria-labelledby="mediumModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title" id="mediumModalLabel"> + Agregar Usuario</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">   
                                    <form action="/Insertar/Usuarios" method="POST">

                                        <div class="form-group">
                                            Nombre
                                            <input type="text" name="name" class="form-control" placeholder="*Nombre (Obligatorio)">
                                        </div>
                                        <div class="form-group">
                                            Correo electrónico
                                            <input type="email" name="email" class="form-control" placeholder="*Correo electrónico (Obligatorio)">
                                        </div>
                                        <div class="form-group">
                                            Usuario
                                            <input type="text" name="user" class="form-control" placeholder="*Nombre de Usuario (Obligatorio)">
                                        </div>
                                        <div class="form-group">
                                            Perfil
                                            <select name="profile" id="profile"  class="form-control" required>
                                                <option value="" selected disabled >Seleccione el Perfil de su cuenta </option>
                                                <option value="1" >Administrador principal</option>
                                                <option value="2" >Administrador</option>
                                                <option value="3" >Usuario final</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            Contraseña
                                            <input type="password" name="password" class="form-control" placeholder="*Contraseña (Obligatorio)">
                                        </div>    
                                        <div class="form-group">
                                            Id Tipo de Usuario
                                            <input type="text" name="idTipoUser" class="form-control" placeholder="*Contraseña (Obligatorio)">
                                        </div>                                           
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                            <button type="submit" class="btn btn-primary">Guardar</button>
                                        </div>
                                    </form>                                    
                                </div>                                        
                            </div>
                        </div>
                    </div>                            
                                       

                </div>
                <div class="modal fade" id="Modal" tabindex="-1" role="form" aria-labelledby="mediumModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title" id="mediumModalLabel"> Eliminar usuario</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                   ¿Estás seguro que deseas eliminar este usuario?
                                </div>
                                </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                <button type="button" class="btn btn-primary">Eliminar</button>
                            </div>
                        </div>
                    </div>
                </div>                            
                <!-- ========================================================--> 
                <!-- INICIA TÍTULOS DE LA TABLA -->
                <!-- ========================================================-->
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                            
                            <!-- ========================================================-->
                            <!-- INICIA TÍTULOS (SUPERIOR) DE LA TABLA -->                                    
                            <thead>
                                <tr>
                                    <th>ID Usuario</th>                                            
                                    <th>Nombre</th>
                                    <th>Correo electrónico</th>
                                    <th>Usuario</th>
                                    <th>Perfil</th>
                                    <th>Acciones</th>
                                                                           
                                </tr>
                            </thead>
                            <!-- FIN TÍTULOS  (SUPERIOR) DE LA TABLA -->
                            <!-- ========================================================-->


                            <!-- ========================================================-->
                            <!-- INICIA TÍTULOS (INFERIOR) DE LA TABLA -->
                            <tfoot>
                                <tr>
                                    <th>ID Usuario</th>                                            
                                    <th>Nombre</th>
                                    <th>Correo electrónico</th>
                                    <th>Usuario</th>
                                    <th>Perfil</th>
                                    <th>Acciones</th>
                                                                           
                                </tr>
                            </tfoot>
                            <!-- ========================================================-->
                            <!-- FIN TÍTULOS (INFERIOR) DE LA TABLA -->

                            <!-- ========================================================-->
                            <!-- INICIA CONTENIDO DE LA TABLA -->
                            <tbody>

                                <!--*******************************************************-->
                                <!--Llamado a la Base de datos de acuerdo a las posiciones-->
                                <!--********************************************************-->

                                {% for item in User %}
                                <tr>
                                    <td>{{item.0}}</td> <!--Id. de usuario en la posicion 0 --->                                          
                                    <td>{{item.1}}</td> <!--Nombre. de usuario en la posicion 1 --->                                                 
                                    <td>{{item.2}}</td> <!--Correo. de usuario en la posicion 2 --->         
                                    <td>{{item.4}}</td> <!--Nick. de usuario en la posicion 4 --->  
                                    {% if item.3 == '1' %}       
                                        <td>Administrador principal</td> <!--Rol. de usuariao en la posicion 3 ---> 
                                    {% elif item.3 == '2' %}  
                                        <td>Administrador</td> <!--Rol. de usuariao en la posicion 3 --->  
                                    {% else %} 
                                        <td>Usuario final</td> <!--Rol. de usuariao en la posicion 3 --->   
                                    {% endif %}   
                                    <td>                                   
                                    <!--*****************************************************************-->      
                                    
                                                                           
                                        <!--***************************************************-->
                                        <!--ACCIÓN DEL NOTÓN EDITAR QUE CONECTA CON EL MODAL-->
                                        <!--***************************************************-->
                                        <a href="" class="btn btn-sm btn-info py-2" data-toggle="modal"  data-target="#largeModal{{item.0}}">
                                            <i  class="fas fa-edit"></i>
                                        </a>
                                        <div class="modal fade" id="largeModal{{item.0}}" tabindex="-1" role="form" aria-labelledby="largeModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h4 class="modal-title" id="largeModalLabel">Editar Usuario</h4>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <form action="/Usuario/update" method="POST">
                                                            <div class="form-group">
                                                                Nombre
                                                                <input type="text" name="name" value="{{item.1}}" class="form-control" placeholder="*Nombre (Obligatorio)">
                                                            </div>
                                                            <div class="form-group">
                                                                Correo electrónico
                                                                <input type="email" name="email" value="{{item.2}}" class="form-control" placeholder="*Correo electrónico (Obligatorio)">
                                                            </div>
                                                            <div class="form-group">
                                                                Perfil
                                                                <select name="profile" id="profile"  class="form-control" required>
                                                                    <option value="" selected disabled>Seleccione un rol </option>
                                                                    <option value="1" >Administrador principal</option>
                                                                    <option value="2" >Administrador</option>
                                                                    <option value="3" >Usuario final</option>
                                                                </select>
                                                            </div>
                                                            <div class="form-group">
                                                                Usuario
                                                                <input type="text" name="user" value="{{item.4}}" class="form-control" placeholder="*Nombre de Usuario (Obligatorio)">
                                                            </div>
                                                            <div class="form-group">
                                                                Contraseña
                                                                <input type="password" value="{{item.5}}" name="password" class="form-control" placeholder="*Contraseña (Obligatorio)">
                                                            </div>
                                                            <div class="form-group">
                                                                Id Tipo de Usuario
                                                                <input type="text" value="{{item.6}}" name="idtipousuario" class="form-control" placeholder="*Contraseña (Obligatorio)">
                                                            </div>                                             
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                                                <button type="submit" class="btn btn-primary">Guardar</button>
                                                            </div>
                                                        </form>                                
                                                    </div>
                                                </div>
                                            </div>
                                        </div>  
                                        <!--*****************************************************************************-->

                                         <!--***************************************************-->
                                        <!--ACCIÓN DEL BOTÓN ELIMINAR QUE CONECTA CON EL MODAL-->
                                        <!--***************************************************-->
                                        <button data-toggle="modal"  data-target="#deleteModal{{item.0}}" class="btn btn-sm btn-danger py-2" type="submit">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <div class="modal fade" id="deleteModal{{item.0}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                                        aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Eliminar a {{item.1}}</h5>
                                                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">×</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">Esta seguro de elminar este usuario?.</div>
                                                <div class="modal-footer">
                                                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                                                    <a class="btn btn-primary" href="/Usuario/delete/{{item.0}}">Eliminar</a>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                        <!--**************************************************************************-->
                                        
                                    <!--***************************************************-->
                                    <!--ACCIÓN DEL NOTÓN EDITAR QUE CONECTA CON EL MODAL-->
                                    <!--***************************************************-->  

                                    </td>                         
                                </tr>
                                {%endfor%}    
         
                            </tbody>
                            <!-- ========================================================-->
                            <!-- FIN CONTENIDO DE LA TABLA -->
                        </table>
                    </div>
                </div>
                <!-- ========================================================--> 
                <!-- FIN TÍTULOS DE LA TABLA -->
                <!-- ========================================================-->
            </div>
        </div>
        <!-- /.container-fluid -->

    </div>
    <!-- End of Main Content -->


    <!-- ========================================================--> 
    <!-- INICIA PIE DE PÁGINA -->
    <!-- ========================================================-->

    <!-- Footer -->
    <footer class="sticky-footer bg-white">
        <div class="container my-auto">
            <div class="copyright text-center my-auto">
                <span>developed by Grupo 7 ©2021 </span>
            </div>
        </div>
    </footer>
    <!-- End of Footer -->

    <!-- ========================================================-->
    <!-- FIN PIE DE PÁGINA -->
    <!-- ========================================================--> 
</div>
<!-- End of Content Wrapper -->
<!-- ========================================================--> 
<!-- FIN CONTENIDO ENVLVENTE -->
<!-- ========================================================-->

</div>
<!-- End of Page Wrapper -->
<!-- ========================================================--> 
<!-- FIN PÁGINA ENVLVENTE -->
<!-- ========================================================-->


<!-- ========================================================--> 
<!-- INICIA MODAL INFORMACIÓN USUARIO -->
<!-- ========================================================--> 
<!-- Logout Modal-->
<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
            </button>
        </div>
        <div class="modal-body">Seleccione "Salir"  para terminar su sesión actual.</div>
        <div class="modal-footer">
            <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            <a class="btn btn-primary" href="{{ url_for('Home') }}">Logout</a>
        </div>
    </div>
</div>
</div>
<!-- ======================================================--> 
<!-- FIN MODAL INFORMACIÓN USUARIO -->
<!-- ======================================================-->

<!-- Bootstrap core JavaScript-->
<script src="static/vendor/jquery/jquery.min.js"></script>
<script src="static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>    

<!-- ==================================================================================--> 
<!-- PERSONALIZA LOS NIVELES DE INFORMACIÓ QUE SE MUESTRA DE LA PÁGINA (Show / Buscar) -->
<!-- ==================================================================================--> 

<!-- Custom scripts for all pages-->
<script src="static/js/sb-admin-2.min.js"></script>

<!-- Page level plugins -->
<script src="static/vendor/datatables/jquery.dataTables.min.js"></script>
<script src="static/vendor/datatables/dataTables.bootstrap4.min.js"></script>



<!-- Page level custom scripts -->
<script src="static/js/demo/datatables-demo.js"></script>

{% endblock %}
